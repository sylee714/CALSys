import pandas as pd

zero_day_exploits = pd.read_csv("zero_day_exploits.csv")
cve_with_descriptions_2015_to_2016 = pd.read_csv("../Files/sorted_data.csv")

# positive_cases = data.loc[data["New Label"] == 't']
# zero_day_exploits_2015_to_2016 = zero_day_exploits.loc[lambda x: "2015" in x['CVE-ID']]
zero_day_exploits_2015 = zero_day_exploits[zero_day_exploits['CVE-ID'].str.contains("-2015-")]
zero_day_exploits_2016 = zero_day_exploits[zero_day_exploits['CVE-ID'].str.contains("-2016-")]

frames = [zero_day_exploits_2015, zero_day_exploits_2016]
zero_day_exploits_2015_to_2016 = pd.concat(frames)

# for index, row in zero_day_exploits_2015_to_2016.iterrows():
#     print(row['CVE-ID'])
#     print(index)

zero_day_exploits_2015_to_2016_with_descriptions = pd.merge(zero_day_exploits_2015_to_2016,
                                                            cve_with_descriptions_2015_to_2016,
                                                            on='CVE-ID')
print(zero_day_exploits_2015_to_2016_with_descriptions)
# for index, row in zero_day_exploits_2015_to_2016_with_descriptions.iterrows():
#     print(row)

# for col in zero_day_exploits_2015_to_2016_with_descriptions.columns:
#     print(col)

zero_day_exploits_2015_to_2016_with_descriptions_with_yes = zero_day_exploits_2015_to_2016_with_descriptions[zero_day_exploits_2015_to_2016_with_descriptions['Zero Day Exploit']==True]
print(zero_day_exploits_2015_to_2016_with_descriptions_with_yes)

# Write to a file
zero_day_exploits_2015_to_2016_with_descriptions.to_csv("zero_day_exploits_with_description.csv", index=False)
